<!-- #include file="/parts/head.html" -->
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
  <h2 id="title" data-navbaractive="navconfigedit">Edit configuration</h2>
</div>
<div id="configfilenames" class="alert alert-info" role="alert">&ensp;</div>
<form id="configuration">
  <input name="submit" type="submit" id="save-button" value="Save configuration" class="btn btn-success" alt="Submit" title="Save configuration&#10;It will become active in next cycle">
  <input name="reset" type="reset" id="reset-button" value="Reset" class="btn btn-warning" alt="Reset" title="Reset configuration data to previous values">
  <button type="button" class="btn btn-primary" id="btn-editconfig" name="btn-editconfig" title="Changed config will become active in next cycle">Edit config file</button>
  <button type="button" class="btn btn-primary" id="btn-editpoolsconfig" name="btn-editpoolsconfig" title="Changed config will become active in next cycle">Edit pools config file</button>
  <br>
  <br>
  <div>
    <table>
      <tr style="vertical-align: top; line-height: 125%">
        <td>
          <!-- Wallet addresses and user names -->
          <legend title="Define your wallet and user names&#10;All your earnings will be sent to the accounts defined here&#10;Correct data is essential" class=h6><b>Wallet addresses and user names</b>
            <button title="Add a new currency to wallet list" class="btn btn-light btn-sm addwalletbutton" id="btn-addwallet" style="height:20px; float: right; padding-top:0px; " type="button">Add new wallet</button>
          </legend>
          <fieldset style="padding-top: 0.3rem;" title="Set your wallet addresses">
            <div id="Wallets"></div>
          </fieldset>
          <br>

          <legend class=h6 title="You must have a registered account with Mining Dutch">Mining Dutch
            <a id="RegisterMiningDutch" href="https://www.mining-dutch.nl/pools/account.php?page=register" target="_blank" hidden style="float: right;" title="Click here to go to the pool registration web site to register an account">Goto registration page</a>
          </legend>
          <div style="padding-top: 0.2rem;" title="Your username as registered with Mining Dutch&#10;(min. 2 and max. 32 characters)">
            <label for="MiningDutchUserName">Mining Dutch user name</label>
            <input type="text" id="MiningDutchUserName" name="MiningDutchUserName" maxlength=33 size=38>
          </div>
          <div title="Your Mining Dutch API Key&#10;taken from your Mining Dutch account settings&#10;If left empty UG-Miner cannot retrieve balance data from Mining Dutch">
            <label for="MiningDutchAPIKey">Mining Dutch API key</label>
            <input type="text" id="MiningDutchAPIKey" name="MiningDutchAPIKey" maxlength=65 size=70>
          </div>
          <br>

          <legend class=h6 title="You must have a registered account with NiceHash">NiceHash
            <a id="RegisterNiceHash" href="https://www.nicehash.com/my/register" target="_blank" hidden style="float: right;" title="Click here to go to the pool registration web site to register an account">Goto registration page</a>
          </legend>
          <div style="padding-top: 0.2rem;" title="Your NiceHash Bitcoin wallet address (must be between 26 and 35 chars long)">
            <label for="NiceHashWallet">NiceHash Bitcoin wallet address</label>
            <input type="text" id="NiceHashWallet" name="NiceHashWallet" minlenght=26 maxlength=35 size=40>
          </div>
          <div title="Your NiceHash API Key&#10;taken from your NiceHash account settings&#10;If left empty UG-Miner cannot retrieve balance data from NiceHash wallet" for="NiceHashAPIKey">
            <label for="NiceHashAPIKey">NiceHash API key</label>
            <input type="text" id="NiceHashAPIKey" name="NiceHashAPIKey" maxlength=37 size=42>
          </div>
          <div title="Your NiceHash API Secret Key&#10;taken from your NiceHash account settings&#10;If left empty UG-Miner cannot retrieve balance data from NiceHash wallet" for="NiceHashAPISecret">
            <label for="NiceHashAPISecret">NiceHash API secret</label>
            <input type="text" id="NiceHashAPISecret" name="NiceHashAPISecret" maxlength=73 size=73>
          </div>
          <div title="Your NiceHash Organization Id (must be 36 chars long)&#10;taken from your NiceHash account settings&#10;If left empty UG-Miner cannot retrieve balance data from NiceHash wallet" for="NiceHashOrganizationId">
            <label for="NiceHashOrganizationId">NiceHash organization Id</label>
            <input type="text" id="NiceHashOrganizationId" name="NiceHashOrganizationId" maxlength=37 size=42>
          </div>
          <br>

          <legend class=h6 title="You must have a registered account with ProHashing">ProHashing
            <a id="RegisterProHashing" href="https://prohashing.com/auth/register?r=3pH68Dhj" target="_blank" hidden style="float: right;" title="Click here to go to the pool registration web site to register an account">Goto registration page</a>
          </legend>
          <div style="padding-top: 0.2rem;" title="Your username as registered with ProHashing" for="ProHashingUserName">
            <label for="ProHashingUserName">ProHashing user name</label>
            <input type="text" id="ProHashingUserName" name="ProHashingUserName" maxlength=37 size=42>
          </div>
          <div title="Your ProHashing API key&#10;taken from your ProHashing account settings&#10;If left empty UG-Miner cannot retrieve balance data from ProHashing" for="ProHashingAPIKey">
            <label for="ProHashingAPIKey">ProHashing API key</label>
            <input type="text" id="ProHashingAPIKey" name="ProHashingAPIKey" maxlength=65 size=70>
          </div>
          <div title="Select the ProHashing mining mode">
          <a href="https://prohashing.com/help/configuring-miners-at-prohashing#miningmodes" target="_blank" title="PPLNS is only supported for algorithms&#10;that have a currency assigned">ProHashing mining mode</a>
          <select style="height: 1.6em;" name="" id="ProHashingMiningMode">
            <option title="Pay Per Share (high pool fee)" value=PPS>PPS</option>
            <option title="Pay Per Last N Shares (lower pool fee)" value=PPLNS>PPLNS</option>
          </select>
          <br><br>

          <!-- Currency settings -->
          <legend class=h6><b>Currency settings</b></legend>
          <div title="Currency used for BTC conversion&#10;Power cost, profit and earnings are shown in this currency">Main (FIAT) currency
            <select style="height: 1.6em;" id="FIATcurrency" name="FIATcurrency" style="margin-top: 0.2rem;"></select>
          </div>
          <div style="padding-top: 0.3em;" title="Default payout currency for all pools&#10;Important: Not all pools allow payouts in currencies other than BTC&#10;Consult the pool API for more information&#10;&#10;Note: This is also a per pool configuration item (edit .'\Config\PoolsConfig.json')">Default payout currency
            <select style="height: 1.6em;" id="PayoutCurrency" name="PayoutCurrency"></select>
          </div>
          <div title="Extra currencies to be shown in balances summary&#10;Values must be separated by commas&#10;&#10;Enter FIAT or crypto currencies&#10;mBTC (milli BTC) is also supported" for="ExtraCurrencies" style="padding-top: 0.3rem;">Extra currencies</label>
            <input type="text" id="ExtraCurrencies" name="ExtraCurrencies" maxlength=45 size=50 value="USD, ETC">
          </div>
          <div style="padding-top: 0.5rem;" title="If enabled UG-Miner will display BTC values in milli BTC">
            <input type="checkbox" class="toggle-switch" id="UsemBTC" name="UsemBTC"> Show BTC values in mBTC (BTC/1000)
          </div>
          <br>

          <!-- General settings -->
          <legend class=h6><b>General settings</b></legend>
          <div style="padding-top: 0.2rem;" title="Identifies your worker&#10;e.g. Computername&#10;(min. 2 and max. 32 characters or numbers)">
            <label for="WorkerName">Worker name</label>
            <input type="text" id="WorkerName" name="WorkerName" maxlength=33 size=38 value="Workername">
          </div>
          <label style="padding-top: 0.2rem;" for="StartupMode" title="Defines UG-Miner startup mode">UG-Miner starts in</label>
          <select style="height: 1.6em;" size=1 title="Defines UG-Miner startup mode" required id="StartupMode">
            <option value="Idle" title="Initiate application, but do not start mining or run any background processes&#10;&#10;Same as pressing the 'Stop Mining' button">idle</option>
            <option value="Paused" title="Initiate application and run background processes, but do not start mining&#10;&#10;Same as pressing the 'Pause Mining' button">paused</option>
            <option value="Running" title="Initiate application and start mining&#10;&#10;Same as pressing the 'Start Mining' button">running</option>
          </select>
          <label for="StartupMode" title="Defines UG-Miner startup mode">mode</label>
          <div title="Mining will start when system is idle, e.g. no mouse&#10;or keyboard activity is detected for n seconds&#10;&#10;(min: 0, max: 3600; default: 120)&#10;&#10;Mining will stop when mouse or keyboard activity is detected">
            <input type="checkbox" class="toggle-switch" id="IdleDetection" name="IdleDetection"> Idle detection: Start mining when system is idle for
            <input type="number" id="IdleSec" name="IdleSec" min=0 max=3600 value=120 step=1 size=4 style="width: 3.8em; text-align:right;"> seconds
          </div>
          <div style="padding-top: 0.5rem;" title="Show the legacy GUI&#10;&#10;Note: You must keep the console window open when you disable the legacy GUI">
            <input type="checkbox" class="toggle-switch" id="LegacyGUI" name="LegacyGUI"> Show legacy GUI
            <input type="checkbox" style="margin-left:20px" class="toggle-switch" id="LegacyGUIStartMinimized" name="LegacyGUIStartMinimized"> Start legacy GUI minimized
          </div>
          <div style="padding-top: 0.7rem;" title="Show the console window&#10;&#10;Note: You must keep the legacy GUI open when you disable the console window">
            <input type="checkbox" class="toggle-switch" id="ShowConsole" name="Show Console"> Show console window
          </div>
          <div style="padding-top: 0.7rem;" title="If enabled miner and rig entries will use different background colors based on status">
            <input type="checkbox" class="toggle-switch" id="UseColorForMinerStatus" name="UseColorForMinerStatus"> Use colors for miner & rig status
          </div>
          <div style="padding-top: 0.4rem;" title="Display numbers with maximal n decimal digits&#10;(larger numbers are shown with less decimal digits)&#10;&#10;(min: 0, max: 10; default: 6)" for="DecimalsMax">Display numbers with maximal
            <input type="number" id="DecimalsMax" name="DecimalsMax" min=0 max=10 value=6 step=1 size=4 style="width: 2.7em; text-align:right;"> decimal digits
          </div>
          <div style="padding-top: 0.5rem;" title="Watchdog will monitor pools & miners for frequent failures&#10;and suspend failing pools or miners for some cycles">
            <input type="checkbox" class="toggle-switch" id="Watchdog" name="Watchdog"> Activate watchdog (recommended)
          </div>
          <div style="padding-top: 0.7rem;" title="Computer will restart when a dead miner is detected&#10;(e.g. miner cannot get stopped gracefully)">
            <input type="checkbox" class="toggle-switch" id="AutoReboot" name="AutoReboot"> Restart computer on dead miners
          </div>
          <div style="padding-top: 0.5rem;" title="Donation duration per day&#10;&#10;Please help support the great team behind UG-Miner&#10;by leaving mining donations turned on&#10;&#10;(min: 0, max: 60, default 13 &#8792; 0.9%)"> Donation 
            <input type="number" id="Donation" name="Donation" min=0 max=60 value=13 style="width: 2.7em; text-align:right;"> minutes per day
          </div>
          <div style="padding-top: 0.3rem;" title="Cycle duration&#10;This defines the approximate duration for one cycle&#10;&#10;(min: 30, max: 3600; default: 90)" for="Interval">Cycle duration
            <input type="number" id="Interval" name="Interval" min=30 max=3600 step=1 value=90 style="width: 3.8em; text-align:right;"> seconds
          </div>
          <div style="padding-top: 0.3rem;" title="Minimum number of continous cycles a miner must mine&#10;the same algorithm[currency]@pool before switching is allowed&#10;&#10;e.g. 3 would force a miner to mine the same algorithm[currency]@pool&#10;for at least 3 cycles before switching to another algorithm or pool&#10;&#10;(min: 1, max: 10; default: 1)&#10;&#10;Note: This does not apply when benchmarking or when the pool is no longer available" for="MinCycle"> Enforce mining for at least
            <input type="number" id="MinCycle" name="MinCycle" min=1 max=10 value=0 step=1 style="width: 2.7em; text-align:right;"> cycles before switching
          </div>
          <div style="padding-top: 0.3rem;" title="Defines the minimum number of data samples to be collected from the miner&#10;while benchmarking before ending the cycle. Smaller numbers will&#10;make benchmarking faster, but the measured data will be less accurate.&#10;&#10;(min: 10, max: 100; default: 20)" for="MinDataSample">Minimum
            <input type="number" id="MinDataSample" name="MinDataSample" min=10 max=100 value=20 step=1 size=4 style="width: 2.8em; text-align:right;"> data samples while benchmarking
          </div>
          <div style="padding-top: 0.2rem;" title="Enter Proxy IP address and port&#10;e.g. 192.168.1.1:3128"> Proxy address:port
            <input type="text" id="Proxy" name="Proxy" maxlength=22 size=30>
          </div>
          <div style="padding-top: 0.4rem;" title="If enabled UG-Miner will open firewall ports for all miners&#10;Admin rights required (or you must accept the UAC prompts)">
            <input type="checkbox" class="toggle-switch" id="OpenFirewallPorts" name="OpenFirewallPorts"> Open firewall ports (admin rights required)
          </div>
          <br>
        </td>
        <td>
          <div style="line-height: 100%" class="col-md-12">
            <!-- Select mining devices -->
            <fieldset title="Enable / disable mining devices&#10;&#10;Unsupported devices are greyed out and cannot be enabled">
              <legend class=h6><b>Select mining devices</b></legend>
              <div id="Devices"></div>
            </fieldset>
            <br>

            <!-- Pool settings -->
            <legend class=h6><b>Pool settings</b></legend>
            <label title="For best network performance UG-Miner will use&#10;the pools closest to the selected region" for="Region">Region </label>
            <select style="height: 1.6em;" id="Region" name="Region" style="margin-top: 0.2rem;"></select>
            <div style="padding-top: 0.2rem;" title="Pools establish fastest network route based on your location&#10;Currently only ZergPool supports this feature">
              <input type="checkbox" class="toggle-switch" id="UseAnycast" name="UseAnycast"> Use anycast for best network performance and ping times
            </div>
            <div style="padding-top: 0.5rem;" title="This setting definines how miners will connect to the pools&#10;&#10;Note: This is also a per pool configuration item (edit .'\Config\PoolsConfig.json').">
              <select style="height: 1.6em;" id="SSL">
                <option value="Never" title="Never use SSL/TLS for pool connections&#10;Pools that enforce SSL/TLS connections are marked as unavailable.&#10;&#10;This setting might reduce earnings because not all pools may allow Non-SSL connections.">Never use</option>
                <option value="Prefer" title="Prefer SSL/TLS pool connections">Prefer</option>
                <option value="Always" title="Always use SSL/TLS for pool connections&#10;Pools that do not support SSL/TLS connections are marked as unavailable.&#10;&#10;This setting might reduce earnings because not all pools & miners support SSL connections.">Always use</option>
              </select>
              <label for="SSL"> SSL/TLS for pool connections</label>
            </div>
            <div style="padding-top: 0.4rem;" title="Some pools use self signed certificates for SSL and/or TLS encryption.&#10;This is a security issue and allows 'Man in the middle attacks'.&#10;&#10;Note: This is also a per pool configuration item (edit .'\Config\PoolsConfig.json')">
              <input type="checkbox" class="toggle-switch" id="SSLallowSelfSignedCertificate" name="SSLallowSelfSignedCertificate"> Allow SSL/TLS connections with self signed certificates
            </div>
            <div style="padding-top: 0.5rem;" title="Minimum workers mining the algorithm at the pool&#10;If less miners are mining the algorithm then the pool will be disabled&#10;&#10;(min: 0, max: 100; default: 10)&#10;Set to 0 to disable this check&#10;&#10;Note: This is also a per pool configuration item (edit .'\Config\PoolsConfig.json')"> Minimum
              <input type="number" step=1 min=0 max=100 value=10 size=3 id="MinWorker" name="MinWorker" style="width: 3em; text-align:right;"> workers at pool
            </div>
            <div style="padding-top: 0.4rem;" title="Allow using the pool even if there is 0 hashrate reported in the pool API&#10;This may cause a lot of miners to fail.&#10;&#10;Note: This is also a per pool setting (edit .'\Config\PoolsConfig.json')">
              <input type="checkbox" id="PoolAllow0Hashrate" class="toggle-switch" name="PoolAllow0Hashrate"> Use pool even if hashrate@pool is 0 (not recommended)
            </div>
            <div style="padding-top: 0.8rem;" title="Allow using the pool even if the price reported in the pool API is 0&#10;This may cause a lot of miners to fail.&#10;&#10;Note: This is also a per pool setting (edit .'\Config\PoolsConfig.json')">
              <input type="checkbox" id="PoolAllow0Price" class="toggle-switch" name="PoolAllow0Price"> Use pool even if price@pool is 0 (not recommended)
            </div>
            <div style="padding-top: 0.8rem;" title="Some miners / algorithms are incompatible with some pools&#10;&#10;If a miner is not compatible with the pool in the best pool list then the miner will not be available&#10;This may affect profitability, but is less CPU heavy">
              <input type="checkbox" class="toggle-switch" id="MinerUseBestPoolsOnly" name="MinerUseBestPoolsOnly"> Only use the pools in the best pool list (not recommended)
            </div>
            <br>

            <!-- Pool selection -->
            <fieldset title="You must select at least one pool">
              <legend class=h6><b>Pool selection</b></legend>
              <div style="padding-top: 0.1rem" id="Pools"></div>
            </fieldset>
            <br>
          </div>
        </td>

        <td>
          <!-- Miner selection -->
          <legend class=h6><b>Miner selection</b></legend>
          <div style="padding-top: 0.3rem;" title="Select miner set to be used by UG-Miner">Use
            <select style="height: 1.6em;" name="" id="MinerSet" width="10">
              <option title="The best miners chosen by the developers may not be the best miners for you&#10;(Minerset 0)" value=0>only best miner per algorithm and per device</option>
              <option title="recommended, select to ensure best profitability&#10;(Minerset 1)" value=1>optimal miners (more than one per algorithm and device)</option>
              <option title="This will prolongue benchmarking, but may not improve profitability&#10;(Minerset 2)" value=2>most miners (excl. those in UnprofitableAlgorithms.json)</option>
              <option title="This will prolongue benchmarking, but will not improve profitability&#10;(Minerset 3) - not recommended" value=3>all miners (incl. those in UnprofitableAlgorithms.json)</option>
            </select>
          </div>
          <div style="padding-top: 0.2rem;" title="List of miners to be excluded&#10;Values must be sparated by commas&#10;&#10;To exclude all versions of a miner specify the short miner name, e.g. 'RigelMiner' (without '-v...')&#10;To exclude a specific miner version use the full miner name, e.g 'GMiner-v3.44' (incl. version information)&#10;"> Exclude miners
            <input type="text" id="ExcludeMinerName" name="ExcludeMinerName" size=47>
          </div>
          <div style="padding-top: 0.2rem;" title="'+[Algorithm]' to enable algorithm or algorithm variant&#10;'-[Algorithm]' to disable algorithm or algorithm variant&#10;Values must be sparated by commas&#10;e.g. '+Ethash,+EtcHash' or '-Ethash(3GB),-Ethash(4GB)'&#10;&#10;Leave empty to use ALL available algorithms&#10;If '+' is used, then only the explicitly enabled algorithms or algorithm variants are used&#10;If '-' is used, then all algorithms or algorithm variants are used except the disabled ones&#10;You can either use '+' or '-'; you cannot combine both&#10;&#10;Note: This is also a per pool configuration item (edit .'\Config\PoolsConfig.json')"> Include / exclude algorithms
            <input type="text" id="Algorithm" name="Algorithm" size=30>
          </div>
          <div style="padding-top: 0.2rem;" title="'+[Currency]' to enable currency&#10;'-[Currency]' to disable currency&#10;Values must be sparated by commas&#10;e.g. '-SATOX,-PAPRY'&#10;&#10;Leave empty to use ALL available currencies&#10;If '+' is used, then only the explicitly enabled currencies are used&#10;If '-' is used, then all currencies are used except the disabled ones&#10;You can either use '+' or '-'; you cannot combine both&#10;&#10;Note: This is also a per pool configuration item (edit .'\Config\PoolsConfig.json')"> Include / exclude currencies
            <input type="text" id="Currency" name="Currency" size=30>
          </div>
          <div style="padding-top: 0.3rem;" title="UG-Miner will disable all miners which sometimes mine to a miner developer wallet (a.k.a. comission or donation)">
            <input type="checkbox" class="toggle-switch" id="DisableMinersWithFee" name="DisableMinersWithFee"> Disable miners with dev fees
          </div>
          <div style="padding-top: 0.6rem;" title="UG-Miner will disable all dual algorithm miners&#10;&#10;Note: This will enable single algorithm mining">
            <input type="checkbox" class="toggle-switch" id="DisableDualAlgoMining" name="DisableDualAlgoMining"> Disable dual algorithm miners
          </div>
          <div style="padding-top: 0.6rem;" title="UG-Miner will disable all single algorithm miners&#10;&#10;Note: This will enable dual algorithm mining">
            <input type="checkbox" class="toggle-switch" id="DisableSingleAlgoMining" name="DisableSingleAlgoMining"> Disable single algorithm miners
          </div>
          <br>

          <!-- Miner runtime settings -->
          <legend title="Miner runtime settings" class=h6><b>Miner runtime settings</b></legend>

          <label for="MinerWindowStyle">Run miner</label>
          <select style="height: 1.6em;" name="" id="MinerWindowStyle">
            <option value = "hidden" title="Miners will run as a hidden background task and are not accessible (not recommended)">as a hidden background task</option>
            <option value = "minimized" title="Miner windows are minimized (default), but accessible">in a minimized window</option>
            <option value = "normal" title="Miner windows are shown normally on desktop">in a normal window</option>
          </select>
          <div title="This is helpful to check the miner output for errors">
            <input type="checkbox" class="toggle-switch" id="MinerWindowStyleNormalWhenBenchmarking" name="MinerWindowStyleNormalWhenBenchmarking"> Run miner in a normal window while benchmarking
          </div>
          <div style="padding-top: 0.3rem;" title="Select the process priority for CPU miners&#10;Higher priorities may lead to fluctuating hashrates with GPU miners">
            <label for="CPUMinerProcessPriority">Run CPU miners with</label>
            <select style="height: 1.6em;" name="" id="CPUMinerProcessPriority">
              <option value = 1>above normal</option>
              <option value = 0>normal</option>
              <option value = -1>below normal</option>
              <option value = -2>idle</option>
            </select>
            <label for="CPUMinerProcessPriority">process priority</label>
          </div>
          <div title="Select the process priority for GPU miners&#10;Higher priorities may lead to fluctuating hashrates with CPU miners">
            <label for="GPUMinerProcessPriority">Run GPU miners with</label>
            <select style="height: 1.6em;" name="" id="GPUMinerProcessPriority">
              <option value = 1>above normal</option>
              <option value = 0>normal</option>
              <option value = -1>below normal</option>
              <option value = -2>idle</option>
            </select>
            <label for="GPUMinerProcessPriority">process priority</label>
          </div>
          <div style="padding-top: 0.2rem;" title="UG-Miner will not use CPU miners while computer is running on battery&#10;&#10;Note: Some laptop computers will lower CPU speed while on battery">
            <input type="checkbox" class="toggle-switch" id="DisableCpuMiningOnBattery" name="DisableCpuMiningOnBattery"> Disable CPU miners while running on battery
          </div>
          <div style="padding-top: 0.6rem;" title="UG-Miner will disable developer fee mining&#10;&#10;Note: Not all miners support disabling their built in fees, others will reduce the hashrate.&#10;For miners that do not allow disabling the miner fees the effective fee will still be shown in the miner list.">
            <input type="checkbox" class="toggle-switch" id="DisableMinerFee" name="DisableMinerFee"> Disable miner fees (where applicable)
          </div>
          <div style="padding-top: 0.6rem;" title="Enable miner specific tweaks, e.g. sharper memory timings or mild overclock&#10;&#10;Note: This may cause stability issues, use with caution!">
            <input type="checkbox" class="toggle-switch" id="UseMinerTweaks" name="UseMinerTweaks"> Enable miner tweaks (admin rights required)
          </div>
          <br>

          <!-- Calculation settings -->
          <legend title="These settings are used to calculate the best miners" class=h6><b>Calculation settings</b></legend>
          <div style="padding-top: 0.3rem;" title="Mark a pool as unavailable if price is x times higher than&#10;the median price of all pools with same algorithm&#10;&#10;(min: 1, max: 10; default: 1.5)&#10;Set to 1 to disable this check&#10;&#10;Note: This applies only to algorithms that have at two least pools"> Unreal pool price factor
            <input type="number" step=0.1 min=1 max=10 value=1.5 size=3 id="UnrealPoolPriceFactor" name="UnrealPoolPriceFactor" style="width: 3em; text-align:right;">
          </div>
          <div style="padding-top: 0.3rem;" title="Mark pool as unavailable if accuracy is below this value&#10;&#10;(min: 0%, max 100%; default: 50%)"> Minimum accuracy
            <input type="number" step=1 min=0 max=100 value=10 size=3 id="MinAccuracy" name="MinAccuracy" style="width: 3em; text-align:right;"> %
          </div>
          <div style="padding-top: 0.5rem;" title="UG-Miner will ignore the pool fee when calculating earnings & profit">
            <input type="checkbox" class="toggle-switch" id="IgnorePoolFee" name="IgnorePoolFee"> Ignore pool fees
          </div>
          <div style="padding-top: 0.3rem;" title="Default factor with which UG-Miner multiplies the prices reported by ALL pools&#10;&#10;E.g. If you feel that the effective earnings seen at the pools are 20% lower than what UG-Miner projects&#10;then set Earnings Adjustment Factor to 0.80&#10;&#10;(min: 0.00, max: 10.00; default: 1.00)" for="EarningsAdjustmentFactor&#10;&#10;Note: This is also a per pool setting (edit .'\Config\PoolsConfig.json')"> Earnings adjustment factor
            <input type="number" id="EarningsAdjustmentFactor" name="EarningsAdjustmentFactor" min=0 max=10 value=1 step=0.01 size=4 style="width: 3.4em; text-align:right;">
          </div>
          <div style="padding-top: 0.3rem;" title="Mark a miner as unavailable if earnings is x times higher than the&#10;next best 10% or at least 5 miners with same algorithm&#10;&#10;(min: 1, max: 99.9; default: 5)&#10;Set to 1 to disable this check">Unreal miner earnings factor
            <input type="number" step=0.1 min=1 max=99.9 value=5 size=3 id="UnrealMinerEarningFactor" name="UnrealMinerEarningFactor" style="width: 3.4em; text-align:right;">
          </div>
          <div style="padding-top: 0.3rem;" title="UG-Miner will not switch miners&#10;unless another miner has n% higher earnings / profit&#10;&#10;Smaller numbers will cause more switching&#10;&#10;(min: 0%, max: 100%; default: 5%)" for="MinerSwitchingThreshold">Miner switching threshold
            <input type="number" id="MinerSwitchingThreshold" name="MinerSwitchingThreshold" min=0 max=100 value=5 step=0.1 size=3 style="width: 3.4em; text-align:right;"> %
          </div>
          <div style="padding-top: 0.5rem;" title="UG-Miner will ignore the miner fee when calculating earnings & profit">
            <input type="checkbox" class="toggle-switch" id="IgnoreMinerFee" name="IgnoreMinerFee"> Ignore miner fees
          </div>
          <div style="padding-top: 0.5rem;" title="Show shares information (Total / Rejected / Accepted) in log">
            <input type="checkbox" class="toggle-switch" id="ShowShares" name="ShowShares"> Show shares information
          </div>
          <div style="padding-top: 0.3rem;" title="Acceptable bad shares threshold ((invalid + rejected + stale) / total) as reported by the miner&#10;If the threshold is exceeded then the miner will get stopped&#10;&#10;(min: 0%, max 100%; default=5%)&#10;Set to 0 to disable this check"> Acceptable bad shares threshold
            <input type="number" step=1 min=0 max=100 value=5 size=3 id="BadShareRatioThreshold" name="BadShareRatioThreshold" style="width: 3em; text-align:right;"> %
          </div>
          <div style="padding-top: 0.5rem;" title="UG-Miner will deduct bad shares (e.g. invalid, rejected or stale) when calculating effective hashrates&#10;This will lower stored hashrates and increase earnings accuracy">
            <input type="checkbox" class="toggle-switch" id="SubtractBadShares" name="SubtractBadShares"> Deduct bad shares when calculating effective hashrates
          </div>
          <div style="padding-top: 0.5rem;" id="ProfitabilityThresholdTitle">
            <label for="ProfitabilityThreshold">Profitability threshold</label>
            <input type="number" step="0.001" min=-999999 max=999999 id="ProfitabilityThreshold" name="ProfitabilityThreshold" value=0.0 style="text-align:right;">
            <label id="ProfitabilityThresholdCurrency" for="ProfitabilityThreshold">
          </div>
          <div style="padding-top: 0.2rem;" title="Calculate power cost, required for true profit calculation&#10;Requires extra configuration of HWiNFO64&#10;(See ConfigHWinfo64.pdf)">
            <input type="checkbox" class="toggle-switch" id="CalculatePowerCost" name="CalculatePowerCost"> Calculate power cost
          </div>
          <div style="padding-top: 0.3rem;" id=PowerPricekWhTitle>
            <label style="margin-left:20px" for="PowerPricekWh">Power price</label>
            <input type="text" id="PowerPricekWh" name="PowerPricekWh" maxlength=128 size=24 value='{"00:00":0.0}'>
            <label id="PowerPricekWhCurrency" for="PowerPricekWh">
          </div>
          <div title="Power consumption of idle system. Part of profit calculation&#10;&#10;(min: 0, max: 999; default: 60)&#10;&#10;Note: When CPU miners are running their&#10;power consumption is deducted from this value">
            <label style="margin-left:20px" for="PowerConsumptionIdleSystemW">Power consumption of idle system</label>
            <input type="number" step=1 min=0 max=999 value=60 size=3 id="PowerConsumptionIdleSystemW" name="PowerConsumptionIdleSystemW" style="width: 3.4em; text-align:right;"> W
          </div>
          <div style="padding-top: 0.2rem;" title="UG-Miner will ignore power cost in best miner selection&#10;and will select miners with best earnings (and not best profit)">
            <input style="margin-left:20px" type="checkbox" class="toggle-switch" id="IgnorePowerCost" name="IgnorePowerCost"> Ignore power cost
          </div>
          <br>

          <!-- Balances tracker settings -->
          <fieldset>
            <legend class=h6><b>Balances tracker settings</b></legend>
            <div style="padding-top: 0.3rem;" title="Interval duration to run background task to periodically collect pool balances & earnings data&#10;&#10;(min: 10, max: 60; default: 15)&#10;Set to 0 to disable the balance tracker&#10;&#10;Note: If set to 0 it will also disable pool balances summary in the Web GUI dashboard and API"> Poll pools for balances & earnings every
              <input type="number" id="BalancesTrackerPollInterval" name="BalancesTrackerPollInterval" length=2 min=0 max=60 step=1 value=15 style="width: 2.7em; text-align:right;"> minutes
            <div style="padding-top: 0.6rem;" title="Show 1hr / 6hrs / 24hr / 7 day & 30day pool earnings sums&#10;(requires 'Poll pools for balances & earnings every n minutes' to be > 0)&#10;&#10;This setting applies to the main text window and web dashboard">
              <input type="checkbox" class="toggle-switch" id="BalancesShowSums" name="BalancesShowSums" style="margin-left:20px"> Show earnings sums for each pool
            </div>
            <div style="padding-top: 0.6rem;" title="Show 1hr / 24hr & 7day pool earnings averages&#10;(requires 'Poll pools for balances & earnings every n minutes' to be > 0)&#10;&#10;This setting applies to the main text window and web dashboard">
              <input type="checkbox" class="toggle-switch" id="BalancesShowAverages" name="BalancesShowAverages" style="margin-left:20px"> Show average earnings for each pool
            </div>
            <div style="padding-top: 0.6rem;" title="Pool balances will be shown in main (FIAT) currency&#10;(requires 'Poll pools for balances & earnings every n minutes' to be > 0)">
              <input type="checkbox" class="toggle-switch" id="BalancesShowInFIATcurrency" name="BalancesShowInFIATcurrency" style="margin-left:20px"> Show pool balances in main (FIAT) currency
            </div>
            <div style="padding-top: 0.6rem;" title="Pool balances will be shown in extra currencies &#10;(requires 'Poll pools for balances & earnings every n minutes' to be > 0)">
              <input type="checkbox" class="toggle-switch" id="BalancesShowInAllCurrencies" name="BalancesShowInAllCurrencies" style="margin-left:20px"> Show pool balances all currencies
            </div>
            <div style="padding-top: 0.6rem;" title="Most pools clear pending balances after a longer period of inactivity&#10;To avoid forfeiting pool balances UG-Miner will enforce mining&#10;at the pool 10 days before it would clear the balance&#10;(one cycle only, even if it is not the most profitable pool)&#10;(requires 'Poll pools for balances & earnings every n minutes' to be > 0)">
              <input type="checkbox" class="toggle-switch" id="BalancesKeepAlive" name="BalancesKeepAlive" style="margin-left:20px"> Keep pool balances alive
            </div>
            <div style="padding-top: 0.6rem;" title="UG-Miner will store all balances tracker data in '.\Logs\BalancesTrackerLog.csv'">
              <input type="checkbox" class="toggle-switch" id="BalancesTrackerLog" name="BalancesTrackerLog" style="margin-left:20px"> Write balances tracker log
            </div>
          </fieldset>
        </td>
        <td style="vertical-align: top; line-height: 125%">
          <!-- Console window display settings -->
          <div class="col-md-12">
            <legend class=h6 title="These Settings will not affect the information available in the in Web GUI"><b>Console window display settings</b></legend>
            <div style="padding-top: 0.3rem;" title="'light' will not show information about previously run & failed miners and watchdog timers&#10;except while benchmarking or measuring power consumption&#10;Can be toggled by pressing '3' in the console window while waiting for the next cycle"> UI Style
              <select style="height: 1.6em;" name="UIStyle" id="UIStyle">
                <option value='full' title="Information about miners run in the past, failed miners & watchdog timers will be shown">full</option>
                <option value='light' title="Information about miners run in the past, failed miners & watchdog timers will not be shown">light</option>
              </select>
            </div>
            <div style="padding-top: 0.5rem;" title="Show the pool balances in the console window&#10;(requires 'Poll pools for balances & earnings every n minutes' to be > 0)&#10;&#10;Can be toggled by pressing '1' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowPoolBalances" name="ShowPoolBalances" > Show pool balances
            </div>
            <div style="padding-top: 0.5rem;" title="When disabled only the best 5 miners per device are shown&#10;except while not benchmarking or measuring power consumption&#10;&#10;Can be toggled by pressing '2' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowAllMiners" name="ShowAllMiners"> Show all optimal miners
            </div>

            <div style="padding-top: 0.8rem;" title="Show the 'Accuracy' column in the console window&#10;&#10;Can be toggled by pressing 'a' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnAccuracy" name="ShowColumnAccuracy"> Show 'Accuracy' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'Coin name' column in the console window&#10;&#10;Can be toggled by pressing 'n' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnCoinName" name="ShowColumnCoinName"> Show 'Coin name' column 
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'Currency' column in the console window&#10;&#10;Can be toggled by pressing 'y' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnCurrency" name="ShowColumnCurrency"> Show 'Currency' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'Earnings column in the console window&#10;&#10;Can be toggled by pressing 'e' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnEarnings" name="ShowColumnEarnings"> Show 'Earnings column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'Earnings bias' column in the console window&#10;&#10;Can be toggled by pressing 'i' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnEarningsBias" name="ShowColumnEarningsBias"> Show 'Earnings bias' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'Hashrate(s)' column in the console window&#10;&#10;Can be toggled by pressing 's' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnHashrate" name="ShowColumnHashrate"> Show 'Hashrates(s)' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the miner 'Fee' column in the console window&#10;&#10;Can be toggled by pressing 'm' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnMinerFee" name="ShowColumnMinerFee"> Show miner 'Fee' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'Pool' column in the console window&#10;&#10;Can be toggled by pressing 'p' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnPool" name="ShowColumnPool"> Show 'Pool' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the pool 'Fee' column in the console window&#10;&#10;Can be toggled by pressing 'f' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnPoolFee" name="ShowColumnPoolFee"> Show pool 'Fee' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'Profit' column in the console window&#10;(requires 'Calculate power cost' to be enabled)&#10;&#10;Can be toggled by pressing 't' in the console window while waiting for the next cycle&#10;">
              <input type="checkbox" class="toggle-switch" id="ShowColumnProfit" name="ShowColumnProfit"> Show 'Profit' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'Profit bias' column in the console window&#10;(requires 'Calculate power cost' to be enabled)&#10;&#10;Can be toggled by pressing 'r' in the console window while waiting for the next cycle&#10;">
              <input type="checkbox" class="toggle-switch" id="ShowColumnProfitBias" name="ShowColumnProfitBias"> Show 'Profit bias' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'Power (W)' column in the console window&#10;(requires 'Calculate power cost' to be enabled)&#10;&#10;Can be toggled by pressing 'w' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnPowerConsumption" name="ShowColumnPowerConsumption"> Show 'Power (W)' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'Power Cost' column in the console window&#10;(requires 'Calculate power cost' to be enabled)&#10;&#10;Can be toggled by pressing 'c' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnPowerCost" name="ShowColumnPowerCost"> Show 'Power cost' column
            </div>
            <div style="padding-top: 0.5rem;" title="Show the 'User' column in the console window&#10;&#10;Can be toggled by pressing 'u' in the console window while waiting for the next cycle">
              <input type="checkbox" class="toggle-switch" id="ShowColumnUser" name="ShowColumnUser"> Show 'User' column
            </div>
            <br>

            <!-- Log to file settings -->
            <fieldset title="Sets the detail level of information written to the log file&#10;&#10;It is recommended to keep at least 'Info' enabled">
              <legend class=h6><b>Log level details (File)</b></legend>
              <div style="padding-top: 0.3rem;" id="LogToFile"></div>
            </fieldset>
            <br>

            <!-- Log to screen settings -->
            <fieldset title="Sets the detail level of information written to the screen&#10;&#10;It is recommended to keep at least 'Info' enabled">
              <legend class=h6><b>Log level details (Screen)</b></legend>
              <div style="padding-top: 0.3rem;" id="LogToScreen"></div>
            </fieldset>
            <br>

            <!-- Auto update settings -->
            <legend class=h6><b>Auto update settings</b></legend>
            <div style="padding-top: 0.3rem;" title="UG-Miner will periodically check for a new program version&#10;&#10;(min: 0, max: 30; default: 1)&#10;Set to 0 to disable checking for new versions"> Check for new version every
              <input type="number" id="AutoUpdateCheckInterval" name="AutoUpdateCheckInterval" min=0 max=50 step=1 value=15 style="width: 2.7em; text-align:right;"> days
            </div>
            <div style="padding-top: 0.4rem;" title="Automatically update UG-Miner to the newest program version&#10;UG-Miner will check for a new version on each start&#10;and every n days as configured by 'AutoUpdateCheckInterval'">
              <input type="checkbox" class="toggle-switch" id="AutoUpdate" name="AutoUpdate"> Automatically install newest version
            </div>
            <div style="padding-top: 0.6rem;" title="If enabled UG-Miner will show the changlog when an update is available">
              <input type="checkbox" class="toggle-switch" id="ShowChangeLog" name="ShowChangeLog"> Show change log
            </div>
            <div style="padding-top: 0.6rem;" title="If enabled UG-Miner will backup installed version before updating to a new version">
              <input type="checkbox" class="toggle-switch" id="BackupOnAutoUpdate" name="BackupOnAutoUpdate"> Backup installed version before updating
            </div>
          </div>
          <br>
        </td>
      </tr>
    </table>
  </div>
  <br>
  <br>
</form>
<!-- Start of page scripts 'configedit.html' -->
<script type="text/javascript">

  const walletscontainer = document.getElementById('Wallets');
  const fiatcurrencycontainer = document.getElementById('FIATcurrency');
  const payoutcurrencycontainer = document.getElementById('PayoutCurrency');
  const poolscontainer = document.getElementById('Pools');
  const regionscontainer = document.getElementById('Region');
  const devicescontainer = document.getElementById('Devices');
  const logtofilecontainer = document.getElementById('LogToFile');
  const logtoscreencontainer = document.getElementById('LogToScreen');

  var configfile = '';
  var regions = [];

  $(document).ready(function () {
    $('body').css('cursor', 'wait');

    // Edit config file
    $('#btn-editconfig').click(function () {
      document.getElementById('btn-editconfig').disabled = true;
      document.getElementById('btn-editpoolsconfig').disabled = true;
      $('.modal-body').load('/functions/file/edit?FileName=' + encodeURIComponent(configfile), function () {
        if (this.outerText) {
          $('.modal-title').text("Edit config file");
          $('#myModal').modal({ 
            show: true
          });
          $('#myModal').on('hidden.bs.modal', function () {
            location.reload(true);
          })
        }
        document.getElementById('btn-editconfig').disabled = false;
        document.getElementById('btn-editpoolsconfig').disabled = false;
      });
    });

    // Edit poolsconfig file
    $('#btn-editpoolsconfig').click(function () {
      document.getElementById('btn-editconfig').disabled = true;
      document.getElementById('btn-editpoolsconfig').disabled = true;
      $('.modal-body').load('/functions/file/edit?FileName=' + encodeURIComponent(poolsconfigfile), function () {
        if (this.outerText) {
          $('.modal-title').text("Edit pools config file");
          $('#myModal').modal({ 
            show: true
          });
        }
        document.getElementById('btn-editconfig').disabled = false;
        document.getElementById('btn-editpoolsconfig').disabled = false;
      });
    });

    // Get FIAT currencies
    $.ajax({
      async: false,
      dataType: 'json',
      url: '/fiatcurrencies',
      success: function (result) {
        fiatcurrencies = result;
      }
    });

    // Get config file names
    $.ajax({
      async: false,
      dataType: 'text',
      url: '/configfile',
      success: function (result) {
        configfile = result;
        $.ajax({
          async: false,
          dataType: 'text',
          url: '/poolsconfigfile',
          success: function (result) {
            poolsconfigfile = result;
            $('#configfilenames').text("Current configuration files: '" + configfile + "' & '" + poolsconfigfile + "'");
          }
        });
      }
    });

    // Wallet addresses and user names
    // Fill wallet addresses
    $.each(config.Wallets, function (key, value) {
      var key = key.toUpperCase();
      $('<div>', { id: key }).appendTo(walletscontainer);
        $('<label/>', { for: ('Wallet' + key), style: 'width:4rem', text: key }).appendTo(document.getElementById(key));
        if (key === 'BTC' || key === 'LTC') $('<input/>', { type: 'text', id: ('Wallet' + key), value: value, name: ('Wallet' + key), minlength: 26, maxlength: 35, size: 64 }).appendTo(document.getElementById(key));
        else if (key === 'ETC' || key === 'ETH') $('<input/>', { type: 'text', id: ('Wallet' + key), value: value, name: ('Wallet' + key), maxlength: 42, size: 64 }).appendTo(document.getElementById(key));
        else $('<input/>', { type: 'text', id: ('Wallet' + key), value: value, name: ('Wallet' + key), size: 64 }).appendTo(document.getElementById(key));
        $('<button/>', { text: 'Remove', title: 'Remove currency from wallet list', type: 'button', class: 'btn btn-light btn-sm removewalletbutton', id: ('btn-remove-wallet-' + key), style: 'margin-left:6px; height:28px; ' }).appendTo(document.getElementById(key));
      $('<div/>').appendTo(walletscontainer);
      $('<option/>', { value: key, text: key }).appendTo(payoutcurrencycontainer);
    })

    // Add wallet address
    $('.addwalletbutton').click(function () {
      $('<div>', { id: 'newwallet' }).appendTo(walletscontainer);
        $('<input type="text" title="Enter crypto currency" id="newwalletcurrency" size=2 minlength=1 maxlength=10>').appendTo(newwallet);
        $('<input type="text" title="Enter wallet address" id="newwalletaddress" size=64 minlength=2 maxlength=100 style=margin-left:6px>').appendTo(newwallet);
        $('<button/>', { text: 'Add', title: 'Add currency to wallet list', type: 'button', class: 'btn btn-light btn-sm addnewwalletbutton', id: 'btn-addnewwallet', style: 'margin-left:6px; height:28px; ' }).appendTo(newwallet);
        $('<button/>', { text: 'Cancel', title: '', type: 'button', class: 'btn btn-light btn-sm cancelnewwalletbutton', id: 'btn-cancelnewwallet', style: 'margin-left:6px; height:28px; ' }).appendTo(newwallet);
      $('<div/>').appendTo(walletscontainer);
      document.getElementById('btn-addwallet').disabled = true;
      document.getElementById('btn-addnewwallet').disabled = true;
      document.getElementById('save-button').disabled = true;
      document.getElementById('reset-button').disabled = true;

      // Add new wallet
      $('.addnewwalletbutton').click(function () {
        var key = document.getElementById('newwalletcurrency').value.toUpperCase();
        var value = document.getElementById('newwalletaddress').value;
        config.Wallets[key] = value;
        $('<div>', { id: key }).appendTo(walletscontainer);
          $('<label/>', { for: ('Wallet' + key), style: 'width:4rem', text: key }).appendTo(document.getElementById(key));
          if (key === 'BTC' || key === 'LTC') $('<input/>', { type: 'text', id: ('Wallet' + key), value: value, name: ('Wallet' + key), minlength: 26, maxlength: 35, size: 64 }).appendTo(document.getElementById(key));
          else if (key === 'ETC' || key === 'ETH') $('<input/>', { type: 'text', id: ('Wallet' + key), value: value, name: ('Wallet' + key), maxlength: 42, size: 64 }).appendTo(document.getElementById(key));
          else $('<input/>', { type: 'text', id: ('Wallet' + key), value: value, name: ('Wallet' + key), size: 64 }).appendTo(document.getElementById(key));
          $('<button/>Remove', { text: 'Remove', title: 'Remove currency from wallet list', type: 'button', class: 'btn btn-light btn-sm removewalletbutton', id: ('btn-remove-wallet-' + key), style: 'margin-left:6px; height:28px; ' }).appendTo(document.getElementById(key));
        $('<div/>').appendTo(walletscontainer);
        $('<option/>', { value: key, text: key }).appendTo(payoutcurrencycontainer);
        document.getElementById('newwallet').remove();
        document.getElementById('btn-addwallet').disabled = false;
        document.getElementById('save-button').disabled = false;
        document.getElementById('reset-button').disabled = false;


        $('.removewalletbutton').click(function () {
          var currency = this.parentElement.id;
          delete config.Wallets[currency];
          $("#PayoutCurrency option[value=" + currency + "]").remove();
          document.getElementById(currency).remove();
        });
      });

      $('#newwalletcurrency').on('input', function() {
        document.getElementById('btn-addnewwallet').disabled = !document.getElementById('newwalletcurrency').value.toString().trim() || !document.getElementById('newwalletaddress').value.toString().trim() || config.Wallets.hasOwnProperty(document.getElementById('newwalletcurrency').value.toUpperCase());
      });
      $('#newwalletaddress').on('input', function(){
        document.getElementById('btn-addnewwallet').disabled = !document.getElementById('newwalletcurrency').value.toString().trim() || !document.getElementById('newwalletaddress').value.toString().trim() || config.Wallets.hasOwnProperty(document.getElementById('newwalletcurrency').value.toUpperCase());
      });

      // Cancel new wallet
      $('.cancelnewwalletbutton').click(function () {
        document.getElementById('newwallet').remove();
        document.getElementById('btn-addwallet').disabled = false;
      });
    });

    // Remove wallet
    $('.removewalletbutton').click(function () {
      var currency = this.parentElement.id;
      delete config.Wallets[currency];
      $("#PayoutCurrency option[value=" + currency + "]").remove();
      document.getElementById(currency).remove();
    });

    // MiningDutch
    document.getElementById('MiningDutchUserName').value = config.MiningDutchUserName || '';
    document.getElementById('MiningDutchAPIKey').value = config.MiningDutchAPIKey || '';
    $(document.getElementById('MiningDutchUserName')).change(function (event) {
      document.getElementById('RegisterMiningDutch').hidden = !Boolean(document.getElementById('MiningDutchUserName').value == "" || document.getElementById('MiningDutchUserName').value == "UselessGuru");
      if (document.getElementById('pool-miningdutch')) { 
        if (!Boolean(document.getElementById('MiningDutchUserName').value)) document.getElementById('pool-miningdutch').checked = false;
        document.getElementById('pool-miningdutch').disabled = !Boolean(document.getElementById('MiningDutchUserName').value)
      };
      if (document.getElementById('pool-miningdutch24hr')) {
        if (!Boolean(document.getElementById('MiningDutchUserName').value)) document.getElementById('pool-miningdutch24hr').checked = false;
        document.getElementById('pool-miningdutch24hr').disabled = !Boolean(document.getElementById('MiningDutchUserName').value)
      };
      if (document.getElementById('pool-miningdutchplus')) {
        if (!Boolean(document.getElementById('MiningDutchUserName').value)) document.getElementById('pool-miningdutchplus').checked = false;
        document.getElementById('pool-miningdutchplus').disabled = !Boolean(document.getElementById('MiningDutchUserName').value)
      };
    });
    $(document.getElementById('MiningDutchUserName')).trigger('change');

    // NiceHash
    document.getElementById('NiceHashWallet').value = config.NiceHashWallet || '';
    document.getElementById('NiceHashAPIKey').value = config.NiceHashAPIKey || '';
    document.getElementById('NiceHashOrganizationId').value = config.NiceHashOrganizationId || '';
    document.getElementById('NiceHashAPISecret').value = config.NiceHashAPISecret || '';
    $(document.getElementById('NiceHashWallet')).change(function (event) {
      document.getElementById('RegisterNiceHash').hidden = Boolean(document.getElementById('NiceHashWallet').value);
      if (document.getElementById('pool-nicehash')) { 
        if (!Boolean(document.getElementById('NiceHashWallet').value.match(/^[0-9A-Za-z]{34}$/))) document.getElementById('pool-nicehash').checked = false;
        document.getElementById('pool-nicehash').disabled = !Boolean(document.getElementById('NiceHashWallet').value.match(/^[0-9A-Za-z]{34}$/));
      };
    });
    $(document.getElementById('NiceHashWallet')).trigger('change');

    // ProHashing
    document.getElementById('ProHashingUserName').value = config.ProHashingUserName || '';
    document.getElementById('ProHashingAPIKey').value = config.ProHashingAPIKey || '';
    if (config.ProHashingMiningMode === 'PPLNS') document.getElementById('ProHashingMiningMode').value = config.ProHashingMiningMode;
    else document.getElementById('ProHashingMiningMode').value = 'PPS';
    $(document.getElementById('ProHashingUserName')).change(function (event) {
      document.getElementById('RegisterProHashing').hidden = !Boolean(document.getElementById('ProHashingUserName').value == "" || document.getElementById('ProHashingUserName').value == "UselessGuru");
      if (document.getElementById('pool-prohashing')) { 
        if (!Boolean(document.getElementById('ProHashingUserName').value)) document.getElementById('pool-prohashing').checked = false;
        document.getElementById('pool-prohashing').disabled = !Boolean(document.getElementById('ProHashingUserName').value)
      };
      if (document.getElementById('pool-prohashing24hr')) {
        if (!Boolean(document.getElementById('ProHashingUserName').value)) document.getElementById('pool-prohashing24hr').checked = false;
        document.getElementById('pool-prohashing24hr').disabled = !Boolean(document.getElementById('ProHashingUserName').value)
      };
      if (document.getElementById('pool-prohashingplus')) {
        if (!Boolean(document.getElementById('ProHashingUserName').value)) document.getElementById('pool-prohashingplus').checked = false;
        document.getElementById('pool-prohashingplus').disabled = !Boolean(document.getElementById('ProHashingUserName').value)
      };
    });
    $(document.getElementById('ProHashingUserName')).trigger('change');

    // Currency settings
    $.each(fiatcurrencies, function(key, value) {
      $('<option/>', { value: key, text: key + ' (' + value + ')' }).appendTo(fiatcurrencycontainer);
    });
    document.getElementById('FIATcurrency').value = config.FIATcurrency.trim();
    document.getElementById('ExtraCurrencies').value = config.ExtraCurrencies.toString().trim();
    document.getElementById('PayoutCurrency').value = config.PayoutCurrency.trim();
    if (config.UsemBTC) document.getElementById('UsemBTC').checked = config.UsemBTC;

    // General settings
    document.getElementById('WorkerName').value = config.WorkerName.trim();
    if (config.StartupMode === 'Idle' || config.StartupMode === 'Paused' || config.StartupMode === 'Running') document.getElementById('StartupMode').value = config.StartupMode;
    else document.getElementById('StartupMode').value = 'Idle';
    // Start paused
    $(document.getElementById('AutoStart')).click(function (event) {
      document.getElementById('StartPaused').disabled = !(document.getElementById('AutoStart').checked);
    });
    if (config.IdleDetection) document.getElementById('IdleDetection').checked = true;
    else document.getElementById('IdleSec').disabled = true;
    document.getElementById('IdleSec').value = parseInt(config.IdleSec);
    if (config.StartPaused) document.getElementById('StartPaused').checked = true;
    // IdleSec
    $(document.getElementById('IdleDetection')).click(function (event) {
      document.getElementById('IdleSec').disabled = !(document.getElementById('IdleDetection').checked);
    });
    if (config.LegacyGUI) document.getElementById('LegacyGUI').checked = true;
    if (config.LegacyGUIStartMinimized) document.getElementById('LegacyGUIStartMinimized').checked = true;
    $(document.getElementById('LegacyGUI')).change(function (event) {
      document.getElementById('LegacyGUIStartMinimized').disabled = !(document.getElementById('LegacyGUI').checked);
      if (!(document.getElementById('LegacyGUI').checked)) {
        document.getElementById('ShowConsole').checked = true;
        $(document.getElementById('ShowConsole')).trigger('change');
      }
    });
    $(document.getElementById('LegacyGUI')).trigger('change');
    if (config.ShowConsole) document.getElementById('ShowConsole').checked = true;
    if (config.UseColorForMinerStatus) document.getElementById('UseColorForMinerStatus').checked = true;
    document.getElementById('DecimalsMax').value = parseInt(config.DecimalsMax);
    if (config.Watchdog) document.getElementById('Watchdog').checked = true;
    if (config.AutoReboot) document.getElementById('AutoReboot').checked = true;
    if (Number.isInteger(config.Donation)) document.getElementById('Donation').value = parseInt(config.Donation);
    // Donation nag
    if (parseInt(document.getElementById('Donation').value) <= 0) {
      $('.modal-title').html('&#128546  Donation duration set to 0 minutes  &#128546');
      $('.modal-body').html('Please help support the great team behind UG-Miner by leaving mining donations turned on&#10;&#10;Thank you!');
      $('#myModal').modal({ show: true });
    };
    document.getElementById('Interval').value = parseInt(config.Interval);
    document.getElementById('MinCycle').value = parseInt(config.MinCycle);
    document.getElementById('MinDataSample').value = parseInt(config.MinDataSample);
    document.getElementById('Proxy').value = config.Proxy.trim();
    if (config.OpenFirewallPorts) document.getElementById('OpenFirewallPorts').checked = true;

    // Select mining devices
    $.ajax({
      async: false,
      dataType: 'json',
      url: '/devices',
      success: function (result) {
        devices = result;
        $.each(devices, function (key, device) {
          $('<input/>', { type: 'checkbox', class: 'toggle-switch', id: ('device-' + device.Name).toLowerCase(), value: device.Name, style: 'margin-top:0.3rem' }).appendTo(devicescontainer);
          $('<label/>', { for: ('device-' + device.Name).toLowerCase(), text: (device.Name + ': ' + device.Model), style: 'margin-left:5px' }).appendTo(devicescontainer);
          $('<br>').appendTo(devicescontainer);
          if (device.State == 0) document.getElementById(('device-' + device.Name).toLowerCase()).checked = true;
          if (device.State == 2) {
            document.getElementById(('device-' + device.Name).toLowerCase()).disabled = true;
            document.getElementById(('device-' + device.Name).toLowerCase()).checked = false;
          }
        })
      }
    });

    // Pool settings
    if (config.UseAnycast) document.getElementById('UseAnycast').checked = true;
    if (config.SSL === 'Never' || config.SSL === 'Prefer' || config.SSL === 'Always') document.getElementById('SSL').value = config.SSL;
    else document.getElementById('SSL').value = 'Prefer';
    if (config.SSLallowSelfSignedCertificate) document.getElementById('SSLallowSelfSignedCertificate').checked = true;
    $(document.getElementById('SSL')).click(function (event) {
      document.getElementById('SSLallowSelfSignedCertificate').disabled = (document.getElementById('SSL').value === 'Never');
    });
    document.getElementById('MinWorker').value = parseInt(config.MinWorker);
    if (config.PoolAllow0Hashrate) document.getElementById('PoolAllow0Hashrate').checked = true;
    if (config.PoolAllow0Price) document.getElementById('PoolAllow0Price').checked = true;
    if (config.MinerUseBestPoolsOnly) document.getElementById('MinerUseBestPoolsOnly').checked = true;

    // Region list
    $.ajax({
      async: false,
      dataType: 'json',
      url: '/regions',
      success: function (result) {
        regions = result;
        $.each(regions, function(key, value) {
          $('<option/>', { text: value }).appendTo(regionscontainer);
        });
      }
    });
    document.getElementById('Region').value = config.Region.trim();

    // Populate pool checkbox list
    const Pools = document.getElementById('Pools');
    const regex = /24hr$|plus$/
    $.ajax({
      async: false,
      dataType: 'json',
      url: '/poolvariants',
      success: function (result) {
        poolvariants = result;
        var poolbasename = '';
        $.each(poolvariants, function (key, poolvariant) {
          if (poolbasename != '' && poolbasename != poolvariant.toLowerCase().replace(regex, '')) $('<br>').appendTo(poolscontainer);
          poolbasename = poolvariant.toLowerCase().replace(regex, '');
          if (poolvariants.filter((poolvariant) => poolvariant.toLowerCase().replace(regex, '').match(poolbasename)).length == 1) {
            title = "You must select at least one pool";
          } else {
            title = "You cannot select multiple variants of the same pool";
          }
          $('<input/>', { type: 'checkbox', class: 'toggle-switch', id: ('pool-' + poolvariant).toLowerCase(), value: poolvariant }).appendTo(poolscontainer);
            $('<label/>', { for: ('pool-' + poolvariant).toLowerCase(), text: poolvariant, title: title, style: 'margin-left: 5px; line-height: 75%;' }).appendTo(poolscontainer);
            $('<br>').appendTo(poolscontainer);
          })
      }
    });

    // Only one pool variant can be checked
    $(Pools).click(function (event) {
      var poolname = (event.target).id.toLowerCase();
      var poolbasename = poolname.toLowerCase().replace(regex, '');
      var pool = document.getElementById(poolbasename);
      if (pool && poolname != pool.id) pool.checked = false;
      var pool = document.getElementById(poolbasename + '24hr');
      if (pool && poolname != pool.id) pool.checked = false;
      var pool = document.getElementById(poolbasename + 'plus');
      if (pool && poolname != pool.id) pool.checked = false;
    });
    $.each([config.PoolName].flat(), function (key, poolvariant) {
      if (document.getElementById(('pool-' + poolvariant).toString().toLowerCase())) document.getElementById(('pool-' + poolvariant).toString().toLowerCase()).checked = true;
    });

    // Miner selection
    if (parseInt(config.MinerSet) >= 0 && parseInt(config.MinerSet) <= 3) document.getElementById('MinerSet').value = config.MinerSet;
    else document.getElementById('MinerSet').value = 2;
    if (config.ExcludeMinerName) document.getElementById('ExcludeMinerName').value = (config.ExcludeMinerName).toString().trim();
    if (config.Algorithm) document.getElementById('Algorithm').value = (config.Algorithm).toString().trim();
    if (config.DisableMinersWithFee) document.getElementById('DisableMinersWithFee').checked = true;
    if (config.DisableDualAlgoMining) document.getElementById('DisableDualAlgoMining').checked = true;
    if (config.DisableSingleAlgoMining) document.getElementById('DisableSingleAlgoMining').checked = true;
    if (config.Currency) document.getElementById('Currency').value = (config.Currency).toString().trim();

    // Dual AND single algorithm mining cannot be disabled at the same time
    $(document.getElementById('DisableDualAlgoMining')).click(function (event) {
      if (document.getElementById('DisableDualAlgoMining').checked) document.getElementById('DisableSingleAlgoMining').checked = false;
    });
    $(document.getElementById('DisableSingleAlgoMining')).click(function (event) {
      if (document.getElementById('DisableSingleAlgoMining').checked) document.getElementById('DisableDualAlgoMining').checked = false;
    });

    // Miner runtime settings
    document.getElementById('MinerWindowStyle').value = config.MinerWindowStyle.toLowerCase();
    if (config.MinerWindowStyleNormalWhenBenchmarking) document.getElementById('MinerWindowStyleNormalWhenBenchmarking').checked = true;
    if (parseInt(config.CPUMinerProcessPriority) >= -2 && parseInt(config.CPUMinerProcessPriority) <= 1) document.getElementById('CPUMinerProcessPriority').value = config.CPUMinerProcessPriority;
    else document.getElementById('CPUMinerProcessPriority').value = -2;
    if (parseInt(config.GPUMinerProcessPriority) >= -2 && parseInt(config.GPUMinerProcessPriority) <= 1) document.getElementById('GPUMinerProcessPriority').value = config.GPUMinerProcessPriority;
    else document.getElementById('GPUMinerProcessPriority').value = -1;
    if (config.DisableCpuMiningOnBattery) document.getElementById('DisableCpuMiningOnBattery').checked = true;
    if (config.DisableMinerFee) document.getElementById('DisableMinerFee').checked = true;
    if (config.UseMinerTweaks) document.getElementById('UseMinerTweaks').checked = true;

    // ProfitabilityThreshold
    $(document.getElementById('FIATcurrency')).change(function (event) {
      document.getElementById('ProfitabilityThresholdCurrency').innerHTML = document.getElementById('FIATcurrency').value.split(',')[0];
      document.getElementById('PowerPricekWhCurrency').innerHTML = '(time: ' + document.getElementById('FIATcurrency').value.split(',')[0] + ' per kW/h)';
      document.getElementById('PowerPricekWhTitle').title = 'Price of power in ' + document.getElementById('FIATcurrency').value.split(',')[0] + ' per kW⋅h, valid from HH:mm (24hr format)\nData must be in compressed JSON format\n\ne.g. {"00:00":0.26; "12:00":0.3} means\nfrom 00:00h to 11:59h: ' + document.getElementById('FIATcurrency').value.split(',')[0] + ' 0.26 per kW/h\nfrom 12:00h to 23:59h: ' + document.getElementById('FIATcurrency').value.split(',')[0] + ' 0.30 per kW/h'
      if (document.getElementById('CalculatePowerCost').checked) document.getElementById('ProfitabilityThresholdTitle').title = 'Mining will stop when profit (earnings - power cost) is less than the configured value\n(e.g. ' + document.getElementById('FIATcurrency').value.split(',')[0] + ' 1.00). Use negative numbers to allow mining at loss.\n\nNote: This does not apply when benchmarking or measuring power consumption'
      else document.getElementById('ProfitabilityThresholdTitle').title = 'Mining will stop when earnings is less than the configured value\n(e.g. ' + document.getElementById('FIATcurrency').value.split(',')[0] + ' 1.00). Use negative numbers to allow mining at loss.\n\nNote: This does not apply when benchmarking'
    });
    $(document.getElementById('FIATcurrency')).trigger('change');

    // Calculation settings
    document.getElementById('UnrealPoolPriceFactor').value = parseFloat(config.UnrealPoolPriceFactor).toFixed(1);
    document.getElementById('MinAccuracy').value = parseFloat(config.MinAccuracy) * 100;
    if (config.IgnorePoolFee) document.getElementById('IgnorePoolFee').checked = true;
    document.getElementById('EarningsAdjustmentFactor').value = parseFloat(config.EarningsAdjustmentFactor).toFixed(1);
    document.getElementById('UnrealMinerEarningFactor').value = parseFloat(config.UnrealMinerEarningFactor).toFixed(1);
    document.getElementById('MinerSwitchingThreshold').value = parseFloat(config.MinerSwitchingThreshold).toFixed(1);
    if (config.ShowShares) document.getElementById('ShowShares').checked = true;
    document.getElementById('BadShareRatioThreshold').value = parseFloat(config.BadShareRatioThreshold) * 100;
    if (config.SubtractBadShares) document.getElementById('SubtractBadShares').checked = true;
    if (config.IgnoreMinerFee) document.getElementById('IgnoreMinerFee').checked = true;
    document.getElementById('ProfitabilityThreshold').value = config.ProfitabilityThreshold;
    if (config.CalculatePowerCost) document.getElementById('CalculatePowerCost').checked = true;
    else {
      document.getElementById('PowerPricekWh').disabled = true;
      document.getElementById('PowerConsumptionIdleSystemW').disabled = true;
      document.getElementById('IgnorePowerCost').disabled = true;
    }
    document.getElementById('PowerPricekWh').value = JSON.stringify(config.PowerPricekWh);
    if (config.IgnorePowerCost) document.getElementById('IgnorePowerCost').checked = true;
    if (parseInt(config.PowerConsumptionIdleSystemW) >= 0) document.getElementById('PowerConsumptionIdleSystemW').value = parseInt(config.PowerConsumptionIdleSystemW);

    // CalculatePowerCost click
    $(document.getElementById('CalculatePowerCost')).click(function (event) {
      document.getElementById('PowerPricekWh').disabled = !(document.getElementById('CalculatePowerCost').checked);
      document.getElementById('PowerConsumptionIdleSystemW').disabled = !(document.getElementById('CalculatePowerCost').checked);
      document.getElementById('IgnorePowerCost').disabled = !(document.getElementById('CalculatePowerCost').checked);
      $(document.getElementById('Currency')).trigger('change');
    });

    // Balance tracker settings
    if (parseInt(config.BalancesTrackerPollInterval) >= 1 && parseInt(config.BalancesTrackerPollInterval) <= 9) document.getElementById('BalancesTrackerPollInterval').value = 10;
    else document.getElementById('BalancesTrackerPollInterval').value = parseInt(config.BalancesTrackerPollInterval);

    // Poll pools for balances & earnings
    $(document.getElementById('BalancesTrackerPollInterval')).change(function (event) {
      if (document.getElementById('BalancesTrackerPollInterval').value == 9) document.getElementById('BalancesTrackerPollInterval').value = 0;
      if (document.getElementById('BalancesTrackerPollInterval').value == 1) document.getElementById('BalancesTrackerPollInterval').value = 10;
      if (document.getElementById('BalancesTrackerPollInterval').value > 1 && document.getElementById('BalancesTrackerPollInterval').value < 9) document.getElementById('BalancesTrackerPollInterval').value = 0;
      document.getElementById('BalancesShowSums').disabled = (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
      document.getElementById('BalancesShowAverages').disabled = (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
      document.getElementById('BalancesShowInFIATcurrency').disabled = (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
      document.getElementById('BalancesShowInAllCurrencies').disabled = (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
      document.getElementById('BalancesKeepAlive').disabled = (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
      document.getElementById('BalancesTrackerLog').disabled = (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
      document.getElementById('ShowPoolBalances').disabled = !(document.getElementById('ShowConsole').checked) || (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
    });
    if (config.BalancesShowSums) document.getElementById('BalancesShowSums').checked = true;
    if (config.BalancesShowAverages) document.getElementById('BalancesShowAverages').checked = true;
    if (config.BalancesShowInFIATcurrency) document.getElementById('BalancesShowInFIATcurrency').checked = true;
    if (config.BalancesShowInAllCurrencies) document.getElementById('BalancesShowInAllCurrencies').checked = true;
    if (config.BalancesKeepAlive) document.getElementById('BalancesKeepAlive').checked = true;
    if (config.BalancesTrackerLog) document.getElementById('BalancesTrackerLog').checked = true;
    $(document.getElementById('BalancesTrackerPollInterval')).trigger('change');

    // Console display settings
    $(document.getElementById('ShowConsole')).change(function (event) {
      document.getElementById('UIStyle').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowPoolBalances').disabled = !(document.getElementById('ShowConsole').checked) || (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
      document.getElementById('ShowAllMiners').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnAccuracy').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnCoinName').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnCurrency').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnEarnings').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnEarningsBias').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnHashrate').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnMinerFee').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnProfit').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnProfitBias').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnPowerConsumption').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnPowerCost').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnPool').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnPoolFee').disabled = !(document.getElementById('ShowConsole').checked);
      document.getElementById('ShowColumnUser').disabled = !(document.getElementById('ShowConsole').checked);
      if (!(document.getElementById('ShowConsole').checked)) {
        document.getElementById('LegacyGUI').checked = true;
        $(document.getElementById('LegacyGUI')).trigger('change');
      }
    });
    $(document.getElementById('ShowConsole')).trigger('change');

    if (config.UIStyle.trim().toLowerCase() == 'full') document.getElementById('UIStyle').value = 'full';
    else document.getElementById('UIStyle').value = 'light';
    if (config.ShowPoolBalances) document.getElementById('ShowPoolBalances').checked = true;
    if (config.ShowAllMiners) document.getElementById('ShowAllMiners').checked = true;
    if (config.ShowColumnAccuracy) document.getElementById('ShowColumnAccuracy').checked = true;
    if (config.ShowColumnCoinName) document.getElementById('ShowColumnCoinName').checked = true;
    if (config.ShowColumnCurrency) document.getElementById('ShowColumnCurrency').checked = true;
    if (config.ShowColumnEarnings) document.getElementById('ShowColumnEarnings').checked = true;
    if (config.ShowColumnEarningsBias) document.getElementById('ShowColumnEarningsBias').checked = true;
    if (config.ShowColumnHashrate) document.getElementById('ShowColumnHashrate').checked = true;
    if (config.ShowColumnMinerFee) document.getElementById('ShowColumnMinerFee').checked = true;
    if (config.ShowColumnProfit) document.getElementById('ShowColumnProfit').checked = true;
    if (config.ShowColumnProfitBias) document.getElementById('ShowColumnProfitBias').checked = true;
    if (config.ShowColumnPool) document.getElementById('ShowColumnPool').checked = true;
    if (config.ShowColumnPoolFee) document.getElementById('ShowColumnPoolFee').checked = true;
    if (config.ShowColumnPowerConsumption) document.getElementById('ShowColumnPowerConsumption').checked = true;
    if (config.ShowColumnPowerCost) document.getElementById('ShowColumnPowerCost').checked = true;
    if (config.ShowColumnUser) document.getElementById('ShowColumnUser').checked = true;

    // CalculatePowerCost click
    $(document.getElementById('CalculatePowerCost')).click(function (event) {
      document.getElementById('ShowColumnPowerConsumption').disabled = !(document.getElementById('ShowConsole').checked) || !(document.getElementById('CalculatePowerCost').checked);
      document.getElementById('ShowColumnPowerCost').disabled = !(document.getElementById('ShowConsole').checked) || !(document.getElementById('CalculatePowerCost').checked);
      document.getElementById('ShowColumnProfit').disabled = !(document.getElementById('ShowConsole').checked) || !(document.getElementById('CalculatePowerCost').checked);
      document.getElementById('ShowColumnProfitBias').disabled = !(document.getElementById('ShowConsole').checked) || !(document.getElementById('CalculatePowerCost').checked);
    });

    // Log to file settings
    values = ["Info", "Warn", "Error", "Verbose", "Debug"];
    $.each(values, function (key, value) {
      $('<input/>', { type: 'checkbox', class: 'toggle-switch', id: ('logtofile-' + value), value: value }).appendTo(logtofilecontainer);
      $('<label/>', { for: ('logtofile-' + value), text: (value), style: 'margin-left:5px' }).appendTo(logtofilecontainer);
      $('<br>').appendTo(logtofilecontainer);
      document.getElementById(('logtofile-' + value)).checked = config.LogToFile.includes(value);
    })

    // Log to screen settings
    values = ["Info", "Warn", "Error", "Verbose", "Debug"];
    $.each(values, function (key, value) {
      $('<input/>', { type: 'checkbox', class: 'toggle-switch', id: ('logtoscreen-' + value), value: value }).appendTo(logtoscreencontainer);
      $('<label/>', { for: ('logtoscreen-' + value), text: (value), style: 'margin-left:5px' }).appendTo(logtoscreencontainer);
      $('<br>').appendTo(logtoscreencontainer);
      document.getElementById(('logtoscreen-' + value)).checked = config.LogToScreen.includes(value);
    })

    // Auto update settings
    if (config.AutoUpdateCheckInterval) document.getElementById('AutoUpdateCheckInterval').value = parseInt(config.AutoUpdateCheckInterval)
    else document.getElementById('AutoUpdateCheckInterval').value = 1;
    if (config.AutoUpdate) document.getElementById('AutoUpdate').checked = true;
    if (config.ShowChangeLog) document.getElementById('ShowChangeLog').checked = true;
    if (config.BackupOnAutoUpdate) document.getElementById('BackupOnAutoUpdate').checked = true;

    $('body').css('cursor', 'default');

    $.ajax({
      async: false,
      dataType: 'json',
      timeout: 10,
      url: '/functions/mining/getstatus',
      success: function(result) {
        if (result == 'FreshConfig') {
          $('.modal-title').text('UG-Miner has no saved configuration');
          $(".modal-body").html("Edit your settings and save the configuration.&#10;&#10;Start making money by clicking 'Start mining'.&#10;&#10;Happy mining!"); 
          $('#myModal').modal({show:true});
        };
      }
    });

    // Error reading configuration
    if (config && configfile && poolvariants && regions && devices) {
      document.getElementById('save-button').disabled = false;
    } else {
      $('.modal-title').text('Error reading configuration');
      $('.modal-body').html('This may be a temporary issue&#10;Please refresh your browser window&#10;&#10;If the problem persists restore the config file and restart UG-Miner.');
      $('#myModal').modal({ show: true });
    }

    $('#configuration').bind('reset', function () {
      location.reload(true);
    });

    $('#configuration').validate({
      rules: {
        WalletBTC: {
          required: false,
          minlength: 26,
          maxlength: 35,
          pattern: '^[0-9A-Za-z]{26,35}$'
        },
        WalletETC: {
          required: false,
          minlength: 42,
          maxlength: 42,
          pattern: '^0[x|X][0-9A-Za-z]{40}$'
        },
        WalletETH: {
          required: false,
          minlength: 42,
          maxlength: 42,
          pattern: '^0[x|X][0-9A-Za-z]{40}$'
        },
        MiningDutchUserName: {
          required: false,
          minlength: 2,
          maxlength: 32,
          pattern: '^[0-9A-Za-z]{2,32}$'
        },
        MiningDutchAPIKey: {
          required: false,
          minlength: 64,
          maxlength: 64,
          pattern: '^[0-9a-f]{64}$'
        },
        NiceHashWallet: {
          required: false,
          minlength: 26,
          maxlength: 35,
          pattern: '^[0-9A-Za-z]{26,35}$'
        },
        NiceHashAPIKey: {
          required: false,
          minlength: 36,
          maxlength: 36,
          pattern: '^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$'
        },
        NiceHashAPISecret: {
          required: false,
          minlength: 72,
          maxlength: 72,
          pattern: '^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{20}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$'
        },
        NiceHashOrganizationId: {
          required: false,
          minlength: 36,
          maxlength: 36,
          pattern: '^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$'
        },
        ProHashingUserName: {
          required: false,
          minlength: 1,
          maxlength: 32,
          pattern: '^.{1,32}$'
        },
        ProHashingAPIKey: {
          required: false,
          minlength: 64,
          maxlength: 64,
          pattern: '^[0-9a-f]{64}$'
        },
        WorkerName: {
          required: true,
          minlength: 2,
          maxlength: 32,
          pattern: '^[0-9A-Za-z=\-]{2,32}$'
        },
        ExtraCurrencies: {
          required: false,
          minlength: 3,
          maxlength: 64,
          pattern: '^([A-Za-z0-9$]{3,4}?)+(?:,([A-Za-z0-9$]{3,4})+)*$'
        },
        IdleSec: {
          digits: true,
          range: [0, 3600],
          required: true,
          step: 1
        },
        Donation: {
          digits: true,
          range: [0, 60],
          required: true,
          step: 1
        },
        Interval: {
          digits: true,
          range: [30, 3600],
          required: true,
          step: 1
        },
        MinDataSample: {
          range: [10, 100],
          required: true,
          step: 1
        },
        MinCycle: {
          digits: true,
          range: [0, 10],
          required: true,
          step: 1
        },
        Proxy: {
          required: false,
          pattern: '^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){4}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
        },
        ExcludeMinerName: {
          required: false,
          minlength: 4,
          maxlength: 256,
          pattern: '^([A-Za-z0-9\-\._]{4,}?)+(?:,(| )([A-Za-z0-9\-\._]{4,})+)*$'
        },
        Algorithm: {
          required: false,
          minlength: 3,
          maxlength: 1024,
          pattern: '^[+|-]([A-Za-z0-9\(\))]{2,}?)+(?:,[+|-]([A-Za-z0-9\(\)]{2,})+)*$'
        },
        PowerPricekWh: {
          maxlength: 256,
          pattern: '^\{"([01][0-9]|2[0-3]):[0-5][0-9]":([0-9]+|[0-9]\.+[0-9]+)(?:,"([01][0-9]|2[0-3]):[0-5][0-9]":([0-9]+|[0-9]\.+[0-9]+))*\}$'
        },
        PowerConsumptionIdleSystemW: {
          digits: true,
          range: [0, 999],
          required: true,
          step: 1
        },
        UnrealPoolPriceFactor: {
          range: [1, 10],
          required: true,
          step: 0.1
        },
        MinAccuracy: {
          range: [0, 100],
          required: true,
          step: 1
        },
        MinWorker: {
          range: [0, 100],
          required: true,
          step: 1
        },
        EarningsAdjustmentFactor: {
          range: [0, 10],
          required: true,
          step: 0.01
        },
        UnrealMinerEarningFactor: {
          range: [1, 99.9],
          required: true,
          step: 0.1
        },
        MinerSwitchingThreshold: {
          range: [0, 99],
          required: true,
          step: 0.1
        },
        BadShareRatioThreshold: {
          range: [0, 100],
          required: true,
          step: 1
        },
        ProfitabilityThreshold: {
          range: [-999999, 999999],
          required: true,
          step: 0.001
        },
        BalancesTrackerPollInterval: {
          digits: true,
          range: [0, 60],
          required: true,
          step: 1
        },
        AutoUpdateCheckInterval: {
          digits: true,
          range: [0, 30],
          required: true,
          step: 1
        }
      },
      messages: {
        Wallet: {
          pattern: "<br>Bitcoin address must be between 26 and 35 characters long<br>and may only contain upper and lower case letters and digits<br>(case sensitive)"
        },
        MiningDutchserName: {
          pattern: "<br>Mining Dutch user name must be between 2 and 32 characters long<br>and may only contain upper and lower case letters and digits<br>(case sensitive)"
        },
        MiningDutchAPIKey: {
          pattern: "<br>Mining Dutch API key must be exactly 64 characters long<br>and may only contain lower case letters (a-f) and digits"
        },
        NiceHashWallet: {
          pattern: "<br>NiceHash internal Bitcoin address must be be between 26 and 35 characters long<br>and may only contain upper and lower case letters and digits<br>(case sensitive)"
        },
        NiceHashAPIKey: {
          pattern: "<br>NiceHash internal Bitcoin address must be exactly 36 characters long<br>and must match '[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}'"
        },
        NiceHashAPISecret: {
          pattern: "<br>NiceHash API secret must be exactly 72 characters long<br>and must match '[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{20}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}'"
        },
        NiceHashOrganizationId: {
          pattern: "<br>NiceHash Organisation ID must be exactly 36 characters long<br>and must match '[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}'"
        },
        ProHashingUserName: {
          pattern: "<br>ProHashing user name must be between 1 and 32 characters long"
        },
        ProHashingAPIKey: {
          pattern: "<br>ProHashing API key must be exactly 64 characters long<br>and may only contain lower case letters (a-f) and digits"
        },
        WorkerName: {
          pattern: "<br>Workername must be between 2 and 32 characters long<br>and may only contain upper and lower case letters and digits<br>(case sensitive)"
        },
        Proxy: {
          pattern: "<br>Enter Proxy IP V4 address and port<br>e.g. 192.168.1.1:3128"
        },
        ExcludeMinerName: {
          minlength: "<br>Miner Name is too short",
          pattern: "<br>Miner names must separated by commas"
        },
        Algorithm: {
          pattern: "<br>Algorithms must be prefixed with '+' or '-' and separated by commas"
        },
        PowerPricekWh: {
          pattern: '<br>Enter a compressed json, e.g. {"00:00":0.26,"12:00":0.3} (max. 256 chars)'
        }
      },
      invalidHandler: function(event, validator) {
        if (validator.numberOfInvalids()) $("#alerts").append('<div class="alert alert-danger alert-dismissible fade show" role="alert">Error saving data - fields with invalid data are marked in red.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>')
      },
      submitHandler: function (form) {
        $('body').css('cursor', 'wait');

        // Wallet addresses and user names
        $.each(config.Wallets, function (key, value) {
          config.Wallets[key] = document.getElementById('Wallet' + key).value.toString();
        });
        config.MiningDutchUserName = document.getElementById('MiningDutchUserName').value.toString().trim();
        config.MiningDutchAPIKey = document.getElementById('MiningDutchAPIKey').value = document.getElementById('MiningDutchAPIKey').value.toString().trim();
        config.NiceHashAPIKey = document.getElementById('NiceHashAPIKey').value = document.getElementById('NiceHashAPIKey').value.toString().trim();
        config.NiceHashAPISecret = document.getElementById('NiceHashAPISecret').value = document.getElementById('NiceHashAPISecret').value.toString().trim();
        config.NiceHashWallet = document.getElementById('NiceHashWallet').value = document.getElementById('NiceHashWallet').value.toString().trim();
        config.NiceHashOrganizationId = document.getElementById('NiceHashOrganizationId').value = document.getElementById('NiceHashOrganizationId').value.toString().trim();
        config.ProHashingAPIKey = document.getElementById('ProHashingAPIKey').value = document.getElementById('ProHashingAPIKey').value.toString().trim();
        config.ProHashingUserName = document.getElementById('ProHashingUserName').value = document.getElementById('ProHashingUserName').value.toString().trim();
        config.ProHashingMiningMode = document.getElementById('ProHashingMiningMode').value;

        // Currency settings
        config.FIATcurrency = document.getElementById('FIATcurrency').value.trim();
        config.ExtraCurrencies = []; // Enforce array
        if (document.getElementById('ExtraCurrencies').value) config.ExtraCurrencies = (document.getElementById('ExtraCurrencies').value).replace(" ", "").split(",");
        config.PayoutCurrency = document.getElementById('PayoutCurrency').value;
        config.UsemBTC = document.getElementById('UsemBTC').checked;

        // General settings
        config.WorkerName = document.getElementById('WorkerName').value.toString().trim();
        if ((document.getElementById('WorkerName').value) == '') config.WorkerName = document.getElementById('WorkerName').value = 'WorkerName';
        if (document.getElementById('StartupMode').value.match('Idle|Paused|Running')) config.StartupMode = document.getElementById('StartupMode').value;
        else config.StartupMode = 'Idle';
        config.IdleDetection = document.getElementById('IdleDetection').checked;
        config.IdleSec = parseInt(document.getElementById('IdleSec').value);
        config.LegacyGUI = document.getElementById('LegacyGUI').checked;
        config.LegacyGUIStartMinimized = document.getElementById('LegacyGUIStartMinimized').checked;
        config.ShowConsole = document.getElementById('ShowConsole').checked;
        config.UseColorForMinerStatus = document.getElementById('UseColorForMinerStatus').checked;
        config.DecimalsMax = parseInt(document.getElementById('DecimalsMax').value);
        config.Watchdog = document.getElementById('Watchdog').checked;
        config.AutoReboot = document.getElementById('AutoReboot').checked;
        config.Donation = parseInt(document.getElementById('Donation').value);
        config.Interval = parseInt(document.getElementById('Interval').value);
        config.MinCycle = parseInt(document.getElementById('MinCycle').value);
        config.MinDataSample = parseInt(document.getElementById('MinDataSample').value);
        config.Proxy = document.getElementById('Proxy').value;
        config.OpenFirewallPorts = document.getElementById('OpenFirewallPorts').checked;

        // Select mining devices
        config.ExcludeDeviceName = [];
        var enabledDevicesCount = 0
        $.each(devices, function (key, device) {
          if (device.State != 2) enabledDevicesCount ++;
          if (document.getElementById(('device-' + device.Name.toLowerCase())).checked == false && device.State != 2) config.ExcludeDeviceName.push(device.Name);
        });

        // Pool settings
        config.Region = document.getElementById('Region').value.trim();
        config.UseAnycast = document.getElementById('UseAnycast').checked;
        if (document.getElementById('SSL').value.match('Never|Prefer|Always')) config.SSL = document.getElementById('SSL').value;
        else config.SSL = 'Prefer';
        config.SSLallowSelfSignedCertificate = document.getElementById('SSLallowSelfSignedCertificate').checked;
        config.MinWorker = parseInt(document.getElementById('MinWorker').value);
        config.PoolAllow0Hashrate = document.getElementById('PoolAllow0Hashrate').checked;
        config.PoolAllow0Price = document.getElementById('PoolAllow0Price').checked;
        config.MinerUseBestPoolsOnly = document.getElementById('MinerUseBestPoolsOnly').checked;

        // Select one or more pools
        config.PoolName = [];
        $.each(poolvariants, function (key, value) {
          if (document.getElementById(('pool-' + value.toLowerCase())).checked == true) config.PoolName.push(value);
        });

        // Miner selection
        config.MinerSet = parseInt(document.getElementById('MinerSet').value);
        config.ExcludeMinerName = []; // enforce array
        if (document.getElementById('ExcludeMinerName').value) config.ExcludeMinerName = document.getElementById('ExcludeMinerName').value.replace(' ', '').split(',');
        config.Algorithm = []; // enforce array
        if (document.getElementById('Algorithm').value) config.Algorithm = document.getElementById('Algorithm').value.replace(' ', '').split(',');
        config.DisableMinersWithFee = document.getElementById('DisableMinersWithFee').checked;
        config.DisableDualAlgoMining = document.getElementById('DisableDualAlgoMining').checked;
        config.DisableSingleAlgoMining = document.getElementById('DisableSingleAlgoMining').checked;

        config.Currency = []; // enforce array
        if (document.getElementById('Currency').value) config.Currency = document.getElementById('Currency').value.replace(' ', '').split(',');

        // Miner runtime settings
        config.MinerWindowStyle = document.getElementById('MinerWindowStyle').value;
        config.MinerWindowStyleNormalWhenBenchmarking = document.getElementById('MinerWindowStyleNormalWhenBenchmarking').checked;
        config.CPUMinerProcessPriority = parseInt(document.getElementById('CPUMinerProcessPriority').value);
        config.GPUMinerProcessPriority = parseInt(document.getElementById('GPUMinerProcessPriority').value);
        config.DisableCpuMiningOnBattery = document.getElementById('DisableCpuMiningOnBattery').checked;
        config.DisableMinerFee = document.getElementById('DisableMinerFee').checked;
        config.UseMinerTweaks = document.getElementById('UseMinerTweaks').checked;

        // Calculation settings
        config.UnrealPoolPriceFactor = parseFloat(document.getElementById('UnrealPoolPriceFactor').value);
        config.MinAccuracy = parseFloat(document.getElementById('MinAccuracy').value) / 100;
        config.IgnorePoolFee = document.getElementById('IgnorePoolFee').checked;
        config.EarningsAdjustmentFactor = parseFloat(document.getElementById('EarningsAdjustmentFactor').value);
        config.UnrealMinerEarningFactor = parseFloat(document.getElementById('UnrealMinerEarningFactor').value);
        config.MinerSwitchingThreshold = parseFloat(document.getElementById('MinerSwitchingThreshold').value);
        config.IgnoreMinerFee = document.getElementById('IgnoreMinerFee').checked;
        config.ShowShares = document.getElementById('ShowShares').checked;
        config.BadShareRatioThreshold = parseFloat(document.getElementById('BadShareRatioThreshold').value) / 100;
        config.SubtractBadShares = document.getElementById('SubtractBadShares').checked;
        config.ProfitabilityThreshold = parseFloat(document.getElementById('ProfitabilityThreshold').value);
        config.CalculatePowerCost = document.getElementById('CalculatePowerCost').checked;
        document.getElementById('PowerPricekWh').value = document.getElementById('PowerPricekWh').value.replace('[', '').replace(']', '');
        if (document.getElementById('PowerPricekWh').value.toString().trim() === '') document.getElementById('PowerPricekWh').value = '{"00:00":0.0}';
        if (document.getElementById('PowerPricekWh').value.toString().trim().match(/^\{"([01][0-9]|2[0-3]):[0-5][0-9]":([0-9]+|[0-9]\.+[0-9]+)(?:,"([01][0-9]|2[0-3]):[0-5][0-9]":([0-9]+|[0-9]\.+[0-9]+))*\}$/)) config.PowerPricekWh = JSON.parse(document.getElementById('PowerPricekWh').value.toString().trim());
        else {
          $('.modal-title').text('Invalid Power Price data');
          $('.modal-body').text('Enter a compressed json, e.g. {"00:00":0.26,"12:00":0.3} (max. 256 chars)');
          $('#myModal').modal({ show: true });
          return false;
        }
        config.PowerConsumptionIdleSystemW = parseInt(document.getElementById('PowerConsumptionIdleSystemW').value);
        config.IgnorePowerCost = document.getElementById('IgnorePowerCost').checked;

        // Balance tracker settings
        config.BalancesTrackerPollInterval = parseInt(document.getElementById('BalancesTrackerPollInterval').value);
        config.BalancesShowSums = document.getElementById('BalancesShowSums').checked;
        config.BalancesShowAverages = document.getElementById('BalancesShowAverages').checked;
        config.BalancesShowInFIATcurrency = document.getElementById('BalancesShowInFIATcurrency').checked;
        config.BalancesShowInAllCurrencies = document.getElementById('BalancesShowInAllCurrencies').checked;
        config.BalancesKeepAlive = document.getElementById('BalancesKeepAlive').checked;
        config.BalancesTrackerLog = document.getElementById('BalancesTrackerLog').checked;

        // Console display settings
        config.UIStyle = document.getElementById('UIStyle').value;
        config.ShowPoolBalances = document.getElementById('ShowPoolBalances').checked;
        config.ShowAllMiners = document.getElementById('ShowAllMiners').checked;
        config.ShowColumnAccuracy =  document.getElementById('ShowColumnAccuracy').checked;
        config.ShowColumnCoinName =  document.getElementById('ShowColumnCoinName').checked;
        config.ShowColumnCurrency =  document.getElementById('ShowColumnCurrency').checked;
        config.ShowColumnEarnings = document.getElementById('ShowColumnEarnings').checked;
        config.ShowColumnEarningsBias = document.getElementById('ShowColumnEarningsBias').checked;
        config.ShowColumnHashrate = document.getElementById('ShowColumnHashrate').checked;
        config.ShowColumnMinerFee = document.getElementById('ShowColumnMinerFee').checked;
        config.ShowColumnPool = document.getElementById('ShowColumnPool').checked;
        config.ShowColumnPoolFee = document.getElementById('ShowColumnPoolFee').checked;
        config.ShowColumnProfit = document.getElementById('ShowColumnProfit').checked;
        config.ShowColumnProfitBias = document.getElementById('ShowColumnProfitBias').checked;
        config.ShowColumnPowerConsumption = document.getElementById('ShowColumnPowerConsumption').checked;
        config.ShowColumnPowerCost = document.getElementById('ShowColumnPowerCost').checked;
        config.ShowColumnUser =  document.getElementById('ShowColumnUser').checked;

        // Log to file settings
        values = ["Info", "Warn", "Error", "Verbose", "Debug"];
        config.LogToFile = [];
        $.each(values, function (key, value) {
          if (document.getElementById(('logtofile-' + value)).checked) config.LogToFile.push(value);
        });

        // Log to screen settings
        values = ["Info", "Warn", "Error", "Verbose", "Debug"];
        config.LogToScreen = [];
        $.each(values, function (key, value) {
          if (document.getElementById(('logtoscreen-' + value)).checked) config.LogToScreen.push(value);
        });

        // Auto update settings
        config.AutoUpdateCheckInterval = parseInt(document.getElementById('AutoUpdateCheckInterval').value);
        config.AutoUpdate = document.getElementById('AutoUpdate').checked;
        config.ShowChangeLog = document.getElementById('ShowChangeLog').checked;
        config.BackupOnAutoUpdate = document.getElementById('BackupOnAutoUpdate').checked;

        // Write current config
        if ((Object.values(config.Wallets).toString().length > 0 || config.MiningDutchUserName.length > 0 || config.NiceHashWallet.length > 0 || config.ProHashingUserName.length > 0) && config.FIATcurrency && config.Region && config.PoolName.length >= 1 && config.ExcludeDeviceName.length < enabledDevicesCount) {
          var $command = '/functions/config/set?' + encodeURIComponent(JSON.stringify(config));
          $('.modal-body').load($command, function () {
            $('.modal-title').text('Save configuration');
            $('#myModal').modal({ show: true });
            $('body').css('cursor', 'default');
            $('#myModal').on('hidden.bs.modal', function () { location.reload(true) })
          });
        } else if (!(Object.values(config.Wallets).toString().length > 0 || config.MiningDutchUserName.length > 0 || config.NiceHashWallet.length > 0 || config.ProHashingUserName.length > 0)) {
          // No wallet or username
          $('.modal-title').html('Error: Invalid configuration');
          $('.modal-body').html('Cannot save configuration - you must set at least one wallet address or username.');
          $('body').css('cursor', 'default');
          $('#myModal').modal({ show: true });
        } else if (!config.Region) {
          // No FIAT currency
          $('.modal-title').html('Error: Invalid configuration');
          $('.modal-body').html('Cannot save configuration - you must set the region.');
          $('body').css('cursor', 'default');
          $('#myModal').modal({ show: true });
        } else if (config.NiceHashWallet == config.Wallets.BTC) {
          // Nicehash wallet
          $('.modal-title').html('Error: Invalid configuration');
          $('.modal-body').html('Cannot save configuration - NiceHash address must be different from your general BTC wallet.');
          $('body').css('cursor', 'default');
          $('#myModal').modal({ show: true });
          } else if (config.ExcludeDeviceName.length >= enabledDevicesCount) {
          // No mining device selected
          $('.modal-title').html('Error: Invalid configuration');
          $('.modal-body').html('Cannot save configuration - you must select at least one mining device.');
          $('body').css('cursor', 'default');
          $('#myModal').modal({ show: true });
        } else if (config.NiceHashWallet == config.Wallets.BTC) {
          // Nicehash wallet
          $('.modal-title').html('Error: Invalid configuration');
          $('.modal-body').html('Cannot save configuration - NiceHash address must be different from your general BTC wallet.');
          $('body').css('cursor', 'default');
          $('#myModal').modal({ show: true });
        } else {
          // No pool selected
          $('.modal-title').html('Error: Invalid configuration');
          $('.modal-body').html('Cannot save configuration - you must select at least one pool.');
          $('body').css('cursor', 'default');
          $('#myModal').modal({ show: true });
        }
      }
    });
    updateSummary();
    updateButtonStatus();
  });
</script>
<!-- End of page scripts 'configedit.html' -->
<!-- #include file="/parts/foot.html" -->